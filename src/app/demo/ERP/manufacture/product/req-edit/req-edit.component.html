<div class="card p-3">
    <div>
        <!-- <div class="card bg-white"> -->
        <button type="button" class="btn back_btn mt-3" (click)="previousPage()"><i
                class="fas fa-arrow-alt-circle-left"></i></button>
        <!-- <div class="card-header">
        </div> -->
        <!-- <div class="card-body"> -->
        <div class="row col-sm-12">
  
            <!-- <div class="col-sm-12 text-right"><button class="btn btn-success" (click)="openModal()"
                [disabled]="item_form.invalid">Add Product</button></div> -->
        </div>
        <form [formGroup]="item_form">
            <div class="col-sm-12 px-0 d-flex flex-row">
                <div class="col-sm-2 ">
                    <label for="">Product Name</label>
                    <input type="text" formControlName="prod_name" class="form-control" readonly>
                    <input type="hidden" formControlName="prod_id" class="form-control" readonly>
                </div>
                <div class="col-sm-2 pl-0">
                    <label for="">GST</label>                    
                    <input type="text" formControlName="gst" class="form-control" readonly>  
                </div>
                <div class="col-sm-2">
                    <label for="">Low Stock</label>
                    <input type="text" formControlName="stock" class="form-control" readonly>
                </div>
                <div class="col-sm-2 ">
                    <label for="">Unit</label>
                    <input type="text" formControlName="unit" class="form-control" readonly>
                </div>
                <div class="col-sm-2">
                    <label for="">Mrp</label>
                    <input type="text" formControlName="mrp" class="form-control" readonly>
                </div>
                <div class="col-sm-2 px-0">
                    <label for="">Hsn</label>
                    <input type="text" formControlName="hsn" class="form-control" readonly>
                </div>
            </div>
        </form>
        
        <!-- <div class="row col-sm-12" *ngIf="productformarray.length!=0">
  
        <div class="col-sm-12 text-right"><button class="btn btn-success"
                (click)="add_purchase_details()">Submit</button></div>
                        </div> -->
  
        <!-- </div> -->
        <!-- </div> -->
  
        <div class="mt-3">
            <form [formGroup]="updatemat">
                <table width="100%" border="1px solid gray" class="text-center"
                    style="border-collapse: separate;text-indent: initial;">
                    <thead class="bg-white">
                        <tr>
                          <!-- <th>Category</th> -->
                            <th>Product</th>
                            <th>Hsn</th>
                            <th>Quantity</th>
                            <th>Sale Price</th>
                            <th>Unit</th>
                            <th>GST</th>
                            <th>Total</th>
                            <th>Action</th>
                        </tr>
  
                    </thead>
                    <tbody>
                        <ng-container formArrayName="product">
                            <tr *ngFor="let Product of updatemat.get('product')['controls'];let i=index"
                                [formGroupName]="i">
                                <!-- <td>
                                    <select class="form-control table_input" id="category"
                                        (change)="chooseCategory($event.target.value); totalCalculation()"
                                        formControlName="category" [disabled]="item_form.invalid">
                                        <option selected value="Choosecat" disabled>Choose Category</option>
                                        <option class="disable" *ngFor="let category of getCatagoryData;let i=index"
                                            [value]="category.cat_id"
                                            [disabled]="Product.controls.edit.value == false">
                                            {{category.cat_name}}</option>
                                    </select>
                                </td> -->
                                <td>
                                    <input type="hidden" formControlName="item_id" >
                                    <select class="form-control table_input" id="item"
                                        (change)="chooseProduct(Product, $event.target.value); totalCalculation()"
                                        formControlName="item" [disabled]="item_form.invalid">
                                        <option selected value="ChooseProduct" disabled>Choose Product</option>
                                        <option class="disable" *ngFor="let prod of itemData2;let i=index"
                                            [value]="prod.prod_id"
                                            [disabled]="Product.controls.edit.value == false">
                                            {{prod.prod_name}}</option>
                                    </select>
                                </td>
                                <td><input type="text" formControlName="hsn" class="form-control table_input" disabled>
                                </td>
                                <td><input type="number" formControlName="qty" id="qty" class="form-control table_input"
                                        (input)="calc_total(Product.controls); totalCalculation()"
                                        (keypress)="prevent($event, 'qty')" min="1"
                                        [readonly]="Product.controls.edit.value == false || Product.controls.item.value == 'ChooseProduct'">
                                </td>
                                <td><input type="number" formControlName="price" id="price"
                                    (input)="calc_total(Product.controls); totalCalculation()"
                                        class="form-control table_input" [readonly]="Product.controls.edit.value == false || Product.controls.item.value == 'ChooseProduct'"></td>
                                <td><input type="text" formControlName="unit"
                                         id="discount" class="form-control table_input"
                                        readonly></td>
                                <td><input type="number" formControlName="gst" class="form-control table_input"
                                        disabled></td>
                                <td><input type="number" formControlName="total" class="form-control table_input"
                                        readonly></td>
                                <!-- <td>
                                <button border="none" class="btn btn-primary disable" (click)="submitArray(i)"
                                    [disabled]="i.invalid"><i class="fas fa-check"></i></button>
                            </td> -->
                                <td class="d-flex flex-row">
                                    <button border="none" class="btn delete_btn disable"
                                        (click)="deleteRow(i); totalCalculation()"
                                        [disabled]="updatemat.get('product').length == 1"><i
                                            class="fas fa-times-circle"></i></button>
                                    <button border="none" class="btn edit_btn disable" formControlName="edit"
                                        (click)="Edit(Product.controls, i)"><i class="fa fa-edit" aria-hidden="true"></i></button>
                                </td>
                            </tr>
                        </ng-container>
                    </tbody>
                    <tfoot style="border: none;">
                        <tr style="border: none;">
                            <td colspan="2" style="white-space: nowrap; float: left; padding: 2px;"><button
                                    class="btn btn-primary disable" (click)="add_row2()"
                                    [disabled]="updatemat.get('product')['controls'][updatemat.get('product')['controls'].length-1].value.item == 'ChooseProduct'">Add
                                    Row</button>
                            </td>
                        </tr>
                    </tfoot>
  
                </table>
  
            </form>
        </div>
  
  
    </div>
  
    <div class="total_cal">
        <table style="width: 290px; color: black;">
            <tr>
                <th style="width: 120px;"></th>
                <th style="width: 50px;"></th>
                <th style="width: 120px;"></th>
            </tr>
            <tr>
                <td>Total GST</td>
                <td>:</td>
                <td><input name="t_gst" [(ngModel)]="t_gst" class="total_cal_field" type="text" readonly></td>
            </tr>
            <tr>
                <td>Total Amount</td>
                <td>:</td>
                <td><input name="t_amount" [(ngModel)]="t_amount" class="total_cal_field" type="text" readonly></td>
            </tr>
        </table>
    </div>
  
    <div class="footer_btn">
        <button class="btn btn-danger mr-2" (click)="previousPage()">Cancel</button>
        <button class="btn btn-primary disable" [disabled]="updatemat.get('product')['controls'][updatemat.get('product')['controls'].length-1].value.item == 'ChooseProduct'" (click)="update_purchase_details()">Update</button>
    </div>
  
  </div>